# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  commons: commons.yml

service:
  display-name: Customers Service
  auth: true
  base-path: /customers
  endpoints:
    createCustomer:
      path: ""
      method: POST
      docs: Create a new customer
      display-name: Create a customer
      request:
        name: CreateCustomerRequest
        body: CustomerInput
      response: commons.Customer

    findCustomer:
      path: /{external_id}
      method: GET
      docs: Return a single customer
      display-name: Find customer by external ID
      path-parameters:
        external_id:
          docs: External ID of the existing customer
          type: string
      response: commons.Customer

    findCustomerCurrentUsage:
      path: /{customer_external_id}/current_usage
      method: GET
      docs: Return a customer current usage
      display-name: Find customer current usage
      path-parameters:
        customer_external_id:
          docs: External ID of the existing customer
          type: string
      request:
        name: FindCustomerCurrentUsageRequest
        query-parameters:
          external_subscription_id:
            docs: External subscription ID
            type: string
      response: CustomerUsage

    findAllCustomers:
      path: ""
      method: GET
      docs: Find all customers in certain organisation
      display-name: Find customers
      request:
        name: FindAllCustomersRequest
        query-parameters:
          page:
            docs: Number of page
            type: optional<integer>
          per_page:
            docs: Number of records per page
            type: optional<integer>
      response: Customers

types:
  CustomerInput:
    properties:
      customer: optional<CustomerInputObject>

  CustomerInputObject:
    properties:
      external_id: optional<string>
      name: optional<string>
      country: optional<string>
      address_line1: optional<string>
      address_line2: optional<string>
      state: optional<string>
      zipode: optional<string>
      email: optional<string>
      city: optional<string>
      url: optional<string>
      phone: optional<string>
      lago_url: optional<string>
      legal_name: optional<string>
      legal_number: optional<string>
      currency: optional<string>
      timezone: optional<string>
      billing_configuration: optional<commons.BillingConfigurationCustomer>

  CustomerUsage:
    properties:
      customer_usage: optional<commons.CustomerUsageObject>

  Customers:
    properties:
      customers: optional<list<commons.CustomerObject>>
